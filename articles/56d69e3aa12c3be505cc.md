---
title: "Ansible 2.8ã«ç§»è¡Œã—ãŸæ™‚mysql_userã§ãƒãƒžã£ãŸã‚¨ãƒ©ãƒ¼"
emoji: "ðŸ”¥"
type: "tech"
topics: ["mysql", "ansible"]
published: true
---

å›žé¿ç­–ã‚’è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚

2.8ã¸ç§»è¡Œã—ãŸã®ãŒåŽŸå› ã‹ã®è©³ã—ã„èª¿æŸ»ã¯ã—ã¦ã„ã¾ã›ã‚“ã€‚

## Before

--checkã—ãŸã¨ã“ã‚ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¤‰ãˆã¦ã„ãªã„ã®ã«changedã«ãªã£ã¦ã„ã¦ãªã‚“ã§ã‹ãªãƒ¼ã¨æ€ã£ã¦å®Ÿè¡Œã—ãŸã‚‰ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ã€‚

```
"msg": "(1144, 'Illegal GRANT/REVOKE command; please consult the manual to see which privileges can be used')"
```

playbookã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã€‚

```yaml
- name: create user
  mysql_user:
    name: user01
    password: password01
    host: "%"
    priv: >-
      db01.*:SELECT,INSERT,UPDATE,DELETE,LOCK TABLES/
      FUNCTION db01.*:EXECUTE,ALTER ROUTINE
```

## After

FUNCTIONã‚’`ã§å›²ã£ã¦ã‚ã’ã‚Œã°å›žé¿å¯èƒ½ã€‚

```yaml
- name: create user
  mysql_user:
    name: user01
    password: password01
    host: "%"
    priv: >-
      db01.*:SELECT,INSERT,UPDATE,DELETE,LOCK TABLES/
      `FUNCTION db01`.*:EXECUTE,ALTER ROUTINE
```
